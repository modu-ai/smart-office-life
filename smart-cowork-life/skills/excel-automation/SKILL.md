---
name: excel-automation
description: "**엑셀 업무 자동화**: 한국 직장인이 가장 많이 쓰는 엑셀의 반복 업무를 자동화합니다. 매출 집계표, 급여 계산, 거래처 관리, 데이터 정리/병합, 피벗 분석, 대시보드 생성을 지원합니다.\n  - MANDATORY TRIGGERS: 엑셀 자동화, 매출 집계, 급여 계산, 거래처 관리, 데이터 정리, 피벗, 엑셀 양식, 스프레드시트 자동화, 재고 관리, 매출 분석"
---

# 엑셀 업무 자동화

## Overview

"회사생활의 반은 엑셀"이라는 말처럼, 한국 직장인의 필수 도구인 엑셀의 반복 업무를 자동화합니다.
xlsx 스킬과 연계하여 수식, 서식, 차트가 포함된 실무용 엑셀 파일을 생성합니다.

> **참고**: 실제 Excel 파일 생성 시에는 xlsx 스킬을 함께 활용합니다.

## 지원 업무 템플릿

| 카테고리 | 템플릿 | 주요 기능 |
|----------|--------|-----------|
| 매출 관리 | 매출 집계표 | 일별/월별/분기별 집계, 전기 대비 |
| 매출 관리 | 매출 분석 대시보드 | 차트, 추세선, KPI 현황 |
| 인사/급여 | 급여 계산서 | 기본급, 수당, 공제, 실수령액 |
| 인사/급여 | 연차/휴가 관리 | 발생/사용/잔여 자동 계산 |
| 거래처 | 거래처 관리대장 | 업체 정보, 거래 이력 |
| 거래처 | 미수금 관리 | 청구/입금/잔액 추적 |
| 재고 | 재고 관리표 | 입고/출고/재고 자동 계산 |
| 프로젝트 | 프로젝트 일정표 | 간트 차트, 진행률 |
| 경비 | 경비 지출 보고서 | 항목별 집계, 예산 대비 |
| 일반 | 데이터 정리/병합 | 중복 제거, 형식 통일 |

## 매출 집계표 구조

### 일별 매출 시트
| 날짜 | 거래처 | 품목 | 수량 | 단가 | 공급가액 | 부가세 | 합계 | 결제방법 | 비고 |
|------|--------|------|------|------|---------|--------|------|---------|------|

### 월별 요약 시트
| 월 | 매출액 | 전월대비 증감 | 증감률 | 누적매출 | 목표매출 | 달성률 |
|---|--------|------------|--------|---------|---------|--------|

### 주요 수식 패턴
```
매출합계: =SUMIFS(매출!F:F, 매출!A:A, ">="&DATE(연,월,1), 매출!A:A, "<"&DATE(연,월+1,1))
전월대비: =(당월-전월)/전월*100
달성률: =실적/목표*100
```

## 급여 계산서 구조

### 급여 명세서
| 항목 | 지급 | 항목 | 공제 |
|------|------|------|------|
| 기본급 | | 국민연금 (4.75%) | |
| 식대 | | 건강보험 (3.595%) | |
| 교통비 | | 장기요양 (건강보험의 13.14%) | |
| 시간외수당 | | 고용보험 (0.9%) | |
| 성과급 | | 소득세 | |
| | | 지방소득세 (소득세의 10%) | |
| **지급 합계** | | **공제 합계** | |
| | **실수령액** | | |

### 4대보험 요율 (2026년 기준)
| 보험 | 전체 요율 | 근로자 부담 | 사업주 부담 | 비고 |
|------|----------|-----------|-----------|------|
| 국민연금 | 9.5% | 4.75% | 4.75% | 2025년 9%→9.5% 인상, 2033년까지 13% 단계 인상 예정 |
| 건강보험 | 7.19% | 3.595% | 3.595% | 2025년 7.09%→7.19% 인상 |
| 장기요양 | 건보료×13.14% | 50% | 50% | 2025년 12.95%→13.14% 인상 |
| 고용보험 | 1.8% | 0.9% | 0.9~1.65% | 동결 |

### 급여 수식 (2026년 적용)
```
국민연금 = 기본급 × 4.75%  (상한: 637만원, 하한: 40만원)
건강보험 = 보수월액 × 3.595%
장기요양 = 건강보험료 × (0.9448 / 7.19) ≈ 건강보험료 × 13.14%
고용보험 = 보수월액 × 0.9%
```

## 대시보드 설계 원칙

### KPI 대시보드 구성 (5~7개 핵심 지표)
```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│  매출액       │  영업이익     │  달성률       │  전월대비     │
│  ₩125,000천  │  ₩28,500천   │  87.5%       │  +12.3%      │
└──────────────┴──────────────┴──────────────┴──────────────┘
┌────────────────────────────┬──────────────────────────────┐
│   월별 매출 추이 (라인)     │   품목별 비중 (도넛/파이)      │
│                            │                              │
└────────────────────────────┴──────────────────────────────┘
```

### 대시보드 구조 규칙
1. **3영역 분리**: 데이터 시트 → 계산 시트 → 대시보드 시트
2. **KPI 카드**: 5~7개 핵심 지표를 상단에 배치
3. **차트 영역**: 하단에 추세/비교 차트 배치
4. **조건부 서식**: 목표 미달(빨강), 달성(초록), 초과(파랑)

## 동적 배열 함수 (Microsoft 365 / Excel 2021+)

### 실무 필수 신규 함수
| 함수 | 용도 | 대체 기능 |
|------|------|----------|
| `XLOOKUP` | 양방향 검색 | VLOOKUP/HLOOKUP/INDEX+MATCH 대체 |
| `FILTER` | 조건 필터링 | 고급필터 대체, 원본 데이터 유지 |
| `SORT` / `SORTBY` | 동적 정렬 | 정렬 기능 대체 |
| `UNIQUE` | 중복 제거 | 중복 항목 제거 대체 |
| `TAKE` / `DROP` | 상위/하위 N개 추출 | TOP N 분석 |
| `LET` | 변수 정의 | 복잡한 수식 가독성 향상 |

### 동적 배열 파이프라인 (실무 예시)
```
# 서울 지역 2026년 매출 TOP 20 (내림차순)
=TAKE(SORTBY(FILTER(A2:F10000, (YEAR(날짜)=2026)*(지역="서울")), 매출열, -1), 20)

# 거래처별 고유 목록 + 자동 정렬
=SORT(UNIQUE(FILTER(거래처!B:B, 거래처!B:B<>"")))

# 조건부 합계 (부서별, 월별)
=SUMIFS(매출!E:E, 매출!C:C, 부서명, MONTH(매출!A:A), 월)
```

## 데이터 정리 가이드

### 자주 쓰는 정리 패턴
1. **중복 제거**: 동일 거래처/품목 합산
2. **형식 통일**: 날짜(YYYY-MM-DD), 금액(천단위 콤마), 전화번호
3. **빈 셀 처리**: 0 또는 "-"로 채우기
4. **텍스트 분리**: 주소에서 시/군/구 분리
5. **XLOOKUP 매칭**: 코드표 기반 명칭 자동 매칭 (VLOOKUP 상위 호환)

### 한국 특화 함수
```
=TEXT(A1, "yyyy년 m월 d일")                              // 한국식 날짜
=TEXT(A1, "#,##0")&"원"                                  // 금액 표기
=TEXT(A1, "#,##0")&"천원"                                // 천단위 표기
=MID(A1,1,3)&"-"&MID(A1,4,4)&"-"&MID(A1,8,4)           // 전화번호 포맷
=LEFT(A1, FIND(" ", A1)-1)                               // 주소에서 시/도 추출
=TEXT(A1*1.1, "#,##0")&"원"                              // 부가세 포함 금액
```

### 실무 자주 쓰는 수식 치트시트
```
# 조건부 집계
=SUMIFS(금액범위, 날짜범위, ">="&시작일, 날짜범위, "<="&종료일)
=COUNTIFS(상태범위, "완료", 담당자범위, "홍길동")
=AVERAGEIFS(점수범위, 부서범위, "영업팀")

# 날짜 함수
=EOMONTH(TODAY(), 0)                    // 이번 달 말일
=NETWORKDAYS(시작일, 종료일)             // 영업일 수 계산
=DATEDIF(입사일, TODAY(), "Y")&"년"      // 근속연수

# 텍스트 가공
=TEXTJOIN(", ", TRUE, 범위)             // 텍스트 합치기
=TEXTBEFORE(A1, "@")                    // @ 앞 텍스트 추출
=TEXTAFTER(A1, "@")                     // @ 뒤 텍스트 추출

# 오류 처리
=IFERROR(XLOOKUP(검색값, 범위, 반환범위), "-")
=IFNA(VLOOKUP(A1, 범위, 2, 0), "미등록")
```

## 조건부 서식 가이드

| 용도 | 규칙 | 서식 |
|------|------|------|
| 달성률 100% 이상 | `=달성률>=100%` | 녹색 배경, 볼드 |
| 달성률 80% 미만 | `=달성률<80%` | 빨강 글씨 |
| 기한 초과 | `=마감일<TODAY()` | 빨강 배경 |
| 음수 표시 | 숫자 서식 `#,##0;[빨강]-#,##0` | 자동 빨강 |
| 데이터 막대 | 매출액 범위 선택 | 그라데이션 막대 |

## 출력 형식

- `.xlsx`: Excel 파일 (수식/서식 포함, 기본값)
- `.csv`: CSV (데이터 교환용)

## 워크플로우

```
사용자 요청 → 업무 유형 파악 → 데이터/요구사항 확인
→ xlsx 스킬로 엑셀 생성 → 수식/서식 적용 → 전달
```
